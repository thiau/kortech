!function e(n,t,o){function r(s,a){if(!t[s]){if(!n[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=t[s]={exports:{}};n[s][0].call(u.exports,function(e){var t=n[s][1][e];return r(t||e)},u,u.exports,e,n,t,o)}return t[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,n,t){!function(){"use strict";var t={messageBox:""},o=e("../factory/factory")(window),r={messageBox:function(){var e=window.document.createElement("div"),n=window.document.createElement("p"),t=window.document.createElement("div"),o=window.document.createElement("div"),r=window.document.createElement("div");return t.classList.add("widget-text-wrapper"),n.classList.add("widget-text"),r.classList.add("widget-icon"),o.classList.add("widget-icon-wrapper"),e.classList.add("widget-wrapper"),e.classList.add("init"),o.appendChild(r),e.appendChild(o),e.appendChild(t),{init:function(n){return e},show:function(o){e.classList.contains("opened")||(e.classList.contains("init")&&e.classList.remove("init"),e.classList.contains("closed")&&e.classList.remove("closed")),e.classList.add("opened"),n.innerText.length>0?(t.removeChild(n),t.appendChild(n)):t.appendChild(n),n.innerText=o||"I didn't get it."},hide:function(){e.classList.contains("opened")&&(e.classList.remove("opened"),e.classList.add("closed"))}}}},i={start:function(n){return new Promise(function(r,i){var s=e("annyang");n||s.debug(),s.start(),s.addCallback("result",function(e,n,i){Array.isArray(e)&&(e=e[0]),t.messageBox.show(e),o.askWatson(e).then(function(e){console.log(e),r(e)}).then(function(){s.removeCallback("result"),s.abort(),window.setTimeout(t.messageBox.hide,2e3)}),console.log(e)})})},stop:function(){annyang.isListening()&&(annyang.removeCallback("result"),annyang.abort())},init:function(e){return console.log("initializing widget"),t.messageBox=r.messageBox(),window.document.body.appendChild(t.messageBox.init("Hello Human")),{start:i.start,stop:i.stop,show:t.messageBox.show,hide:t.messageBox.hide}}};n.exports={init:i.init}}()},{"../factory/factory":2,annyang:4}],2:[function(e,n,t){!function(){"use strict";n.exports=function(n){var t={askWatson:"https://duda-app.mybluemix.net/askWatson"};return n.Promise||(n.Promise=e("promise-polyfill")),{setUrl:function(e,n){t[n]=e},getUrl:function(e){return t[e]||"Invalid URL requested"},askWatson:function(e){return new Promise(function(o,r){if(!e)return r("Can not proceed without credentials");if(n.XMLHttpRequest){var i=new n.XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status||201===i.status)if(i.responseText)try{o(JSON.parse(i.responseText))}catch(e){o(i.responseText)}else r("An error occurred: Empty response");else r(["An error occurred:",i.responseText].join())},i.open("POST",t.askWatson),i.setRequestHeader("content-type","application/json"),i.send(JSON.stringify({question:e}))}else r("AJAX Calls not supported on this browser")})},getModel:function(){return new Promise(function(e,o){if(n.XMLHttpRequest){var r=new n.XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status)if(r.responseText)try{e(JSON.parse(r.responseText))}catch(n){e(r.responseText)}else o("An error occurred: Empty response");else o(["An error occurred: ",r.responseText].join())},r.open("GET",t.urlModel),r.send()}else o("AJAX Calls not supported on this browser")})}}}}()},{"promise-polyfill":5}],3:[function(e,n,t){!function(n){"use strict";var t=e("./controller/controller");n.init=t.init}(window)},{"./controller/controller":1}],4:[function(e,n,t){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.annyang=t(e)}):"object"===(void 0===n?"undefined":o(n))&&n.exports?n.exports=t(e):e.annyang=t(e)}("undefined"!=typeof window?window:void 0,function(e,n){var t,r=e.SpeechRecognition||e.webkitSpeechRecognition||e.mozSpeechRecognition||e.msSpeechRecognition||e.oSpeechRecognition;if(!r)return null;var i,s,a=[],c={start:[],error:[],end:[],soundstart:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},u=0,l=0,f=!1,d="font-weight: bold; color: #00f;",p=!1,h=!1,m=/\s*\((.*?)\)\s*/g,g=/(\(\?:[^)]+\))\?/g,y=/(\(\?)?:\w+/g,w=/\*\w+/g,v=/[\-{}\[\]+?.,\\\^$|#]/g,b=function(e){return e=e.replace(v,"\\$&").replace(m,"(?:$1)?").replace(y,function(e,n){return n?e:"([^\\s]+)"}).replace(w,"(.*?)").replace(g,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i")},x=function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];e.forEach(function(e){e.callback.apply(e.context,t)})},_=function(){return i!==n},R=function(e,n){-1!==e.indexOf("%c")||n?console.log(e,n||d):console.log(e)},L=function(){_()||t.init({},!1)},k=function(e,n,t){a.push({command:e,callback:n,originalPhrase:t}),f&&R("Command successfully loaded: %c"+t,d)},S=function(e){x(c.result,e);for(var n,t=0;t<e.length;t++){n=e[t].trim(),f&&R("Speech recognized: %c"+n,d);for(var o=0,r=a.length;o<r;o++){var i=a[o],s=i.command.exec(n);if(s){var u=s.slice(1);return f&&(R("command matched: %c"+i.originalPhrase,d),u.length&&R("with parameters",u)),i.callback.apply(this,u),void x(c.resultMatch,n,i.originalPhrase,e)}}}x(c.resultNoMatch,e)};return t={init:function(o){var d=!(arguments.length>1&&arguments[1]!==n)||arguments[1];i&&i.abort&&i.abort(),(i=new r).maxAlternatives=5,i.continuous="http:"===e.location.protocol,i.lang="en-US",i.onstart=function(){h=!0,x(c.start)},i.onsoundstart=function(){x(c.soundstart)},i.onerror=function(e){switch(x(c.error,e),e.error){case"network":x(c.errorNetwork,e);break;case"not-allowed":case"service-not-allowed":s=!1,(new Date).getTime()-u<200?x(c.errorPermissionBlocked,e):x(c.errorPermissionDenied,e)}},i.onend=function(){if(h=!1,x(c.end),s){var e=(new Date).getTime()-u;(l+=1)%10==0&&f&&R("Speech Recognition is repeatedly stopping and starting. See http://is.gd/annyang_restarts for tips."),e<1e3?setTimeout(function(){t.start({paused:p})},1e3-e):t.start({paused:p})}},i.onresult=function(e){if(p)return f&&R("Speech heard, but annyang is paused"),!1;for(var n=e.results[e.resultIndex],t=[],o=0;o<n.length;o++)t[o]=n[o].transcript;S(t)},d&&(a=[]),o.length&&this.addCommands(o)},start:function(e){L(),p=(e=e||{}).paused!==n&&!!e.paused,s=e.autoRestart===n||!!e.autoRestart,e.continuous!==n&&(i.continuous=!!e.continuous),u=(new Date).getTime();try{i.start()}catch(e){f&&R(e.message)}},abort:function(){s=!1,l=0,_()&&i.abort()},pause:function(){p=!0},resume:function(){t.start()},debug:function(){var e=!(arguments.length>0&&arguments[0]!==n)||arguments[0];f=!!e},setLanguage:function(e){L(),i.lang=e},addCommands:function(n){var t;L();for(var r in n)if(n.hasOwnProperty(r))if("function"==typeof(t=e[n[r]]||n[r]))k(b(r),t,r);else{if(!("object"===(void 0===t?"undefined":o(t))&&t.regexp instanceof RegExp)){f&&R("Can not register command: %c"+r,d);continue}k(new RegExp(t.regexp.source,"i"),t.callback,r)}},removeCommands:function(e){e===n?a=[]:(e=Array.isArray(e)?e:[e],a=a.filter(function(n){for(var t=0;t<e.length;t++)if(e[t]===n.originalPhrase)return!1;return!0}))},addCallback:function(t,o,r){var i=e[o]||o;"function"==typeof i&&c[t]!==n&&c[t].push({callback:i,context:r||this})},removeCallback:function(e,t){var o=function(e){return e.callback!==t};for(var r in c)c.hasOwnProperty(r)&&(e!==n&&e!==r||(c[r]=t===n?[]:c[r].filter(o)))},isListening:function(){return h&&!p},getSpeechRecognizer:function(){return i},trigger:function(e){return t.isListening()?(Array.isArray(e)||(e=[e]),void S(e)):void(f&&R(h?"Speech heard, but annyang is paused":"Cannot trigger while annyang is aborted"))}}})},{}],5:[function(e,n,t){!function(e){function t(){}function o(e,n){return function(){e.apply(n,arguments)}}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function i(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(e){return void a(n.promise,e)}s(n.promise,o)}else(1===e._state?s:a)(n.promise,e._value)})):e._deferreds.push(n)}function s(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof r)return e._state=3,e._value=n,void c(e);if("function"==typeof t)return void l(o(t,n),e)}e._state=1,e._value=n,c(e)}catch(n){a(e,n)}}function a(e,n){e._state=2,e._value=n,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)i(e,e._deferreds[n]);e._deferreds=null}function u(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function l(e,n){var t=!1;try{e(function(e){t||(t=!0,s(n,e))},function(e){t||(t=!0,a(n,e))})}catch(e){if(t)return;t=!0,a(n,e)}}var f=setTimeout;r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,n){var o=new this.constructor(t);return i(this,new u(e,n,o)),o},r.all=function(e){var n=Array.prototype.slice.call(e);return new r(function(e,t){function o(i,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){o(i,e)},t)}n[i]=s,0==--r&&e(n)}catch(e){t(e)}}if(0===n.length)return e([]);for(var r=n.length,i=0;i<n.length;i++)o(i,n[i])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(n){n(e)})},r.reject=function(e){return new r(function(n,t){t(e)})},r.race=function(e){return new r(function(n,t){for(var o=0,r=e.length;o<r;o++)e[o].then(n,t)})},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){f(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==n&&n.exports?n.exports=r:e.Promise||(e.Promise=r)}(this)},{}]},{},[3]);